services:
  snip-agent:
    tty: true
    stdin_open: true
    build:
      context: .
      dockerfile_inline: |
        FROM golang:1.25.2-alpine
        WORKDIR /app
        COPY . .

        RUN go mod tidy
        ENTRYPOINT ["go", "run", "main.go"]
    ports:
      - 3500:8080
    environment:
      SYSTEM_INSTRUCTION: |
        You are Snip, an AI assistant that helps users write and understand code snippets.
        You provide concise explanations, code examples, and best practices for various programming tasks.
        Always aim to be clear, helpful, and accurate in your responses.

      HTTP_PORT: 8080

      SNIPPETS_FOLDER: snippets
      SIMILARITY_THRESHOLD: 0.6
      SIMILARITY_MAX_RESULTS: 3

      CONTEXT_SIZE_LIMIT: 8192

    volumes:
      - ./data/snippets:/app/snippets
      #- ./store:/app/store      

    models:
      snip-model:
        endpoint_var: MODEL_RUNNER_BASE_URL
        model_var: SNIP_MODEL
      embedding-model:
        endpoint_var: MODEL_RUNNER_BASE_URL
        model_var: EMBEDDING_MODEL

models:
  snip-model:
    #model: hf.co/menlo/jan-nano-gguf:q4_k_m
    model: ai/qwen2.5:latest
    context_size: 8192
    #model: hf.co/menlo/lucy-gguf:q4_k_m
    # context_size: 4096
    runtime_flags:
        - "--temp"                # Temperature
        - "0.0"                   # Set temperature to 0.0  
        - "--verbose"
        - "--verbose-prompt"
  embedding-model:
    model: ai/mxbai-embed-large:latest

